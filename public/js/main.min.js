/*! Copyright 2014 CINC (www.infocinc.com)
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
*/
;var CANVAS_RATIO;var DROPS_DRAWN=false;$.fn.isOnScreen=function(){var win=$(window);var viewport={top:win.scrollTop(),left:win.scrollLeft()};viewport.right=viewport.left+win.width();viewport.bottom=viewport.top+win.height();var bounds=this.offset();bounds.right=bounds.left+this.outerWidth();bounds.bottom=bounds.top+this.outerHeight();return(!(viewport.right<bounds.left||viewport.left>bounds.right||viewport.bottom<bounds.top||viewport.top>bounds.bottom))};function registerMediaCallbacks(){mediaSwitch=false;enquire.register("screen and (min-width:992px)",{unmatch:function(){graph.orientation="horizontal";graph.update([Math.random()*10,Math.random()*10,Math.random()*10,Math.random()*10,Math.random()*10,Math.random()*10,Math.random()*10]);CANVAS_RATIO=0.4},match:function(){graph.orientation="vertical";graph.update([Math.random()*10,Math.random()*10,Math.random()*10,Math.random()*10,Math.random()*10,Math.random()*10,Math.random()*10]);CANVAS_RATIO=0.62}});enquire.register("screen and (min-width:768px)",{unmatch:function(){mediaSwitch=true;if($("#fixed-bar").hasClass("navbar-mini")){$("#fixed-bar").removeClass("navbar-mini")}navMiniMode=false;$.each(carousels,function(key,value){value.stop()});$("#services button, #team button").off();clearInterval(refreshIntervalId);setBarGraph()},match:function(){if(mediaSwitch||site_state==="MOBILE"){initCarousel("services");initCarousel("team");clearInterval(refreshIntervalId);setBarGraph()}var stop=$("#services-banner").offset().top;if((!navMiniMode)&&(stop<$(window).scrollTop())){$("#fixed-bar").addClass("navbar-mini");navMiniMode=true}$("#services button").on("click",function(event){selectButton("services",this);var targetId=event.target.id;var sectionId=$(this).closest(".container-fluid").prop("id");showPanel(sectionId,targetId)});$("#team button").on("click",function(event){selectButton("team",this);var targetId=event.target.id;var sectionId=$(this).closest(".container-fluid").prop("id");showPanel(sectionId,targetId)})}})}function queryMediaState(){var size=parseInt($("#media-state").css("font-size"),10);var site_shape;if(size===1){site_shape="MOBILE"}else{if(size===2){site_shape="TABLET-PORTRAIT"}else{if(size===3){site_shape="TABLET-LANDSCAPE"}else{if(size===4){site_shape="DESKTOP-LG"}else{site_shape="DESKTOP-WIDE"}}}}return site_shape}var graph,refreshIntervalId,graphCanvasId;function setBarGraphCtx(canvasId){var w,h;var canvas=document.getElementById(canvasId);var site_state=queryMediaState();graphCanvasId=canvasId;if(typeof G_vmlCanvasManager!="undefined"){canvas=G_vmlCanvasManager.initElement(canvas)}var selector="#"+canvasId;if(canvasId==="screen-canvas"){if(site_state==="TABLET-PORTRAIT"){w=$("#screen-services-visual").width()}else{w=0.3*$("#screen-services").width()}h=CANVAS_RATIO*$("#screen-services").height()}else{w=0.8*$("#services").width();h=200}$(selector).attr({width:w,height:h});barGraphCtx=canvas.getContext("2d")}function createBarGraph(){var lastOrientation="horizontal";if(typeof graph!=="undefined"&&graphCanvasId!=="excel-canvas"){lastOrientation=graph.orientation}graph=new BarGraph(barGraphCtx);graph.margin=5;graph.orientation=lastOrientation;graph.width=barGraphCtx.canvas.width;graph.height=barGraphCtx.canvas.height;graph.xAxisLabelArr=["A","B","C","D","E","F","G"];graph.update([Math.random()*10,Math.random()*10,Math.random()*10,Math.random()*10,Math.random()*10,Math.random()*10,Math.random()*10]);refreshIntervalId=setInterval(function(){graph.update([Math.random()*10,Math.random()*10,Math.random()*10,Math.random()*10,Math.random()*10,Math.random()*10,Math.random()*10])},4000)}function prefix(id){return id.split("-")[0].trim()}function fadeHtml(obj,direction,complete){if(direction==="in"){$(obj.selector).fadeIn("linear",function(){if(complete){complete()}})}else{$(obj.selector).fadeOut("linear",function(){complete(obj)})}}function parse(sectionId,buttonId,suffix){var pre=prefix(buttonId);var o={};o.id="#"+pre+"-"+suffix;o.html=$(o.id).html().trim();o.selector="#"+sectionId+"-"+suffix;if(prefix(sectionId)===sectionId){o.selector="#screen-"+sectionId+"-"+suffix}return o}var firstPanel=true;function showPanel(sectionId,buttonId){var t=parse(sectionId,buttonId,"text");var p=parse(sectionId,buttonId,"photo");if(firstPanel){$(t.selector).html(t.html);$(p.selector).html(p.html);firstPanel=false;return}var buttonPrefix=prefix(buttonId);var htmlCallback=function(ob){$(ob.selector).html(ob.html)};var excelCallBack=function(ob){if(buttonPrefix==="excel"){$("#screen-canvas-wrapper").css("display","none");$("#screen-canvas-wrapper").removeClass("hide");$("#screen-canvas-wrapper").fadeIn()}else{$(ob.selector).html(ob.html);fadeHtml(ob,"in")}};var scrollToCallBack=function(ob){$("#screen-services #consult-anchor").scrollTo({speed:800,offset:0,easing:"easeInOutCubic"})};fadeHtml(t,"out",htmlCallback);canvasHide="none"!==$("#screen-canvas-wrapper").css("display");if(canvasHide&&sectionId==="services"){$("#screen-canvas-wrapper").fadeOut(function(){$(p.selector).css("display","none");$(p.selector).html(p.html);fadeHtml(p,"in")})}else{fadeHtml(p,"out",excelCallBack)}if(buttonPrefix==="consult"){fadeHtml(t,"in",scrollToCallBack)}else{fadeHtml(t,"in")}}function carouselHandler(direction){var waypoint=this.id;var panelDisplay=$("#"+waypoint+" .content-block").css("display");if(panelDisplay=="none"&&direction=="down"&&carousels[waypoint]===undefined){initCarousel(waypoint)}}function teamHandler(direction){var length=$("#screen-team-photo").html().trim().length;if(direction==="down"&&length===0){showPanel("team","nic-button")}}var hero_anchors=["#top-hero-anchor","#services-hero-anchor","#method-hero-anchor","#project-hero-anchor","#team-hero-anchor"];var footer_anchors=["#hero-footer-anchor","#services-footer-anchor","#team-footer-anchor","#method-footer-anchor","#top-footer-anchor","#project-footer-anchor","#contact-hero-anchor"];var main_nav_anchors=["#service-nav-anchor","#method-nav-anchor","#team-nav-anchor","#footer-nav-anchor"];function registerScrollsTo(){var media_state=queryMediaState();$(main_nav_anchors.join()).scrollTo({speed:800,offset:0,easing:"easeInOutCubic"});$(hero_anchors.join()).scrollTo({speed:1500,offset:0,easing:"easeInOutCubic"});if(media_state!=="MOBILE"){$(footer_anchors.join()).scrollTo({speed:1500,offset:0,easing:"easeInOutCubic"})}}function resize(){var mediaState=queryMediaState();if(DROPS_DRAWN){var w=CANVAS_WIDTH=$("#bubbles-wrapper").width();var h=CANVAS_HEIGHT=$("#bubbles-wrapper").height();if(context.canvas.width!==CANVAS_WIDTH||context.canvas.height!==CANVAS_HEIGHT){context.canvas.width=CANVAS_WIDTH;context.canvas.height=CANVAS_HEIGHT;background.src="../img/rain.jpg"}}if($("#excel-text").css("display")==="none"){if(mediaState==="TABLET-PORTRAIT"){w=$("#screen-services-visual").width()}else{w=0.3*$("#screen-services").width()}h=CANVAS_RATIO*$("#screen-services").height()}else{w=0.8*$("#services").width();h=200}if(barGraphCtx.canvas.width!==w||barGraphCtx.canvas.height!==h){barGraphCtx.canvas.width=w;barGraphCtx.canvas.height=h;graph.width=barGraphCtx.canvas.width;graph.height=barGraphCtx.canvas.height}}function selectButton(sectionId,buttonId){var c=carousels[sectionId];var b=buttonSelected[sectionId];if(c!==undefined){c.pause()}if(b!==undefined){$(b).removeClass("selected-button")}buttonSelected[sectionId]=buttonId;$(buttonId).addClass("selected-button")}function resizeHandlers(){window.addEventListener("resize",resize,false)}function setBarGraph(){var site_state=queryMediaState();if(site_state==="TABLET-PORTRAIT"){CANVAS_RATIO=0.3}else{CANVAS_RATIO=0.62}if($("#excel-photo").css("display")==="none"){setBarGraphCtx("screen-canvas")}else{setBarGraphCtx("excel-canvas")}createBarGraph()}function initDrops(){if($("#bubbles-wrapper").css("display")==="none"){return}REFRESH_RATE=40;t=1;MAX_BUBBLES=90;background=new Image();background.src="../img/rain.jpg";canvas=document.getElementById("bubbles");var selector="#bubbles";var w=$("#bubbles-wrapper").width();var h=$("#bubbles-wrapper").height();$(selector).attr({width:w,height:h});CANVAS_WIDTH=w;CANVAS_HEIGHT=h;context=canvas.getContext("2d");context.drawImage(background,0,0);bubbles=new Array(MAX_BUBBLES);for(var i=0;i<MAX_BUBBLES;i++){bubbles[i]=new Bubble()}DROPS_DRAWN=true;setInterval(drawDrops,REFRESH_RATE)}function setResponsiveLine(id){var offset=$(id).offset();var windowHeight=$(window).height();var boxHeight=parseInt($(id+" a").css("height"),10);var delta=windowHeight-(offset.top+boxHeight);if(delta>0){$(id+" .responsive-line").css({height:delta+"px","max-height":"200px"})}else{$(id+" .responsive-line").css({height:"80px"})}}var site_state;function adaptForMobile(){site_state=queryMediaState();if(site_state==="MOBILE"){$("#fbook-anchor").attr("href","https://m.facebook.com/pages/infocinc/896328063714402");$("#footer-fbook-anchor").attr("href","https://m.facebook.com/pages/infocinc/896328063714402");var viewportHeight=$(window).height();$("#phone_anchor img").attr("src","img/phonelogo.png");$("#phone_anchor").prop("href","tel:+14384966886")}}function initWayPoints(){$("#services,#screen-method").waypoint(carouselHandler,{offset:"50%"});$("#team").waypoint(teamHandler,{offset:"50%"})}function arrowUpNoHashTag(){$("#arrow-up-anchor").on("click",function(e){e.preventDefault();var loc=window.location;window.location.href="#";if(history.pushState){history.pushState("",document.title,loc.pathname)}})}function createGaEvent(label,value,url){e={hitType:"event",eventCategory:"button",eventAction:"click",eventLabel:label,eventValue:value,page:url,nonInteraction:false};return e}function registerMouseClicks(){var path=document.location.pathname;$("#lang-wrapper").on("click",function(){eo=createGaEvent("lang-button",1,path);ga("send",eo)});$(".center-navigation").on("click",function(){eo=createGaEvent("nav-button",1,path);ga("send",eo)});$("#services-icons button, #team button").on("click",function(e){eo=createGaEvent(e.target.id,1,path);ga("send",eo)});$("#navbar-collapse a").on("click",function(e){var navitem=$(e.target).text().toLowerCase()+"-menuitem";eo=createGaEvent(navitem,1,path);ga("send",eo)})}function init(){var oldIE=detectIE();if(oldIE){return}initWayPoints();setResponsiveLine("#main-nav-1");initSlider();registerScrollsTo();resizeHandlers();adaptForMobile();arrowUpNoHashTag();registerMouseClicks();$("#skype-call-anchor").prop("href","skype:infoCinc?call");document.addEventListener("touchstart",function(){},false);setBarGraph();registerMediaCallbacks();initDrops()}function detectIE(){var oldIE;if($("html").is(".lt-ie9")){oldIE=true}if(oldIE){$("#main").css("display","none")}return oldIE}$(function(){init()});